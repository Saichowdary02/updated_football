<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Smart Football Selection Assistant{% endblock %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Clerk Authentication -->
    <script async crossorigin="anonymous" data-clerk-publishable-key="{{ clerk_publishable_key }}"
        src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js" type="text/javascript"></script>
</head>

<body>
    <!-- Clean Header for Logged In Users -->
    <nav class="navbar-app">
        <div class="nav-brand">
            <a href="/home" onclick="showSection('home')">
                <i class="fas fa-futbol"></i>
                <span>Smart Football Selection Assistant</span>
            </a>
        </div>
        <div class="nav-right">
            <!-- Section Navigation Pills -->
            <div class="nav-pills">
                <button class="nav-pill active" data-section="home" onclick="showSection('home')">
                    <i class="fas fa-home"></i> Home
                </button>
                <button class="nav-pill" data-section="single_player" onclick="showSection('single_player')">
                    <i class="fas fa-user"></i> Single Player
                </button>
                <button class="nav-pill" data-section="multiplayer" onclick="showSection('multiplayer')">
                    <i class="fas fa-users"></i> Multiplayer
                </button>
                <button class="nav-pill" data-section="compare" onclick="showSection('compare')">
                    <i class="fas fa-scale-balanced"></i> Compare
                </button>
            </div>
            <!-- Theme Toggle -->
            <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle Dark Mode"
                style="background: none; border: none; font-size: 1.2rem; cursor: pointer; color: white; margin-right: 15px;">
                <i class="fas fa-moon"></i>
            </button>
            <!-- Clerk User Button -->
            <div id="clerk-user-button"></div>
        </div>
    </nav>

    <div class="main-content">
        {% block content %}{% endblock %}
    </div>

    <footer>
        <p>&copy; Smart Football Selection Assistant | <span class="powered-by">Powered by <i class="fas fa-brain"></i>
                ML</span></p>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script>
        // Initialize Clerk
        window.addEventListener('load', async function () {
            try {
                await Clerk.load();

                // Mount user button if user is signed in
                if (Clerk.user) {
                    Clerk.mountUserButton(document.getElementById('clerk-user-button'));

                    // Load user profile data after Clerk is ready
                    if (typeof loadUserProfile === 'function') {
                        loadUserProfile();
                    }
                } else {
                    // Redirect to landing if not authenticated
                    window.location.href = '/';
                }
            } catch (error) {
                console.error('Clerk initialization error:', error);
            }
        });

        // Set initial section based on active_page from server
        document.addEventListener('DOMContentLoaded', function () {
            const activePage = '{{ active_page }}';
            if (activePage && activePage !== 'home') {
                showSection(activePage);
            }
        });
    </script>
</body>

</html>